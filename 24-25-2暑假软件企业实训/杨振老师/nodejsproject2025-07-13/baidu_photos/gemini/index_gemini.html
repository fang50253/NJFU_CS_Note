<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<!-- 显示消息的盒子 -->
<div id="responseBox" style="height: 400px; width: 95%; margin: 20px auto; overflow-y: auto; border: 1px solid black; padding: 10px;">
</div>

<!-- 输入和按钮区域 -->
<div style="text-align: center; margin-top: 10px;">
  <input id="userInput" style="width: 60%; padding: 5px;" placeholder="请输入指令">
  <button class="btn" style="padding: 6px 12px; margin-left: 10px;">询问</button>
</div>

<script>
  $(document).ready(function () {
    $('.btn').click(function () {
      const inputText = $('#userInput').val().trim();
      if (!inputText) return;

      // 显示“我”的内容，蓝色
      $('#responseBox').append(`<div style="color: blue;">我：${$('<div>').text(inputText).html()}</div>`);

      // 发请求给后端
      $.ajax({
        url: 'http://127.0.0.1:3000/ask',
        method: 'POST',
        contentType: 'application/json',
        data: JSON.stringify({ prompt: inputText }),
        success: function (data) {
          $('#responseBox').append(`<div style="color: black;">Gemini：${$('<div>').text(data).html()}</div>`);
          $('#responseBox').scrollTop($('#responseBox')[0].scrollHeight);
        },
        error: function () {
          $('#responseBox').append('<div style="color: red;">AI：请求失败，请检查后端接口</div>');
          $('#responseBox').scrollTop($('#responseBox')[0].scrollHeight);
        }
      });

      // 清空输入框
      $('#userInput').val('');

      // 滚动到底部
      $('#responseBox').scrollTop($('#responseBox')[0].scrollHeight);
    });
  });
</script>
</body>
</html>