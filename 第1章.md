# 第一章.操作系统引论
## 1.1操作系统的目标和作用
### 1.1.1操作系统的目标
* 有效性：提高系统资源利用率和系统吞吐量
* 方便性：提供用户操作接口
* 可扩充性：方便增加新的功能和模块
* 开放性：遵循国际标准，便于相互兼容
### 1.1.2操作系统的作用
* OS作为用户与计算机硬件系统之间的接口：OS处于用户与计算机硬件系统之间，用户通过OS来使用计算机系统；用户在OS帮助下，能够方便、快捷、安全、可靠地操纵计算机硬件和运行自己的程序；OS是一个系统软件，因而这种接口是软件接口。  
* OS作为计算机系统资源的管理者：在一个计算机系统中，通常都含有各种各样的硬件和软件资源。归纳起来可将资源分为四类：**处理器、存储器、I/O设备、信息(数据和程序)**。相应地，OS的主要功能也正是针对这四类资源进行有效的管理。  
* OS实现了对计算机资源的抽象：对于一台完全无软件的计算机系统(即裸机)，即使其功能再强，也必定是难于使用的。在裸机上覆盖上一层I/O设备管理软件,将是一台比裸机功能更强、使用更方便的机器。通常把覆盖了软件的机器称为扩充机器或虚机器。
### 1.1.3推动操作系统发展的主要动力 
* 不断提高计算机资源利用率：充分利用有限的硬件资源 
* 方便用户：简化操作
* 器件的不断更新换代：为软件的发展提供了基础 
* 计算机体系结构的不断发展：功能逐步强大
## 1.2  操作系统的发展过程 
### 1.2.1无操作系统的计算机系统 
* 人工操作方式
* 脱机输入/输出(Off-Line I/O)方式
### 1.2.2单道批处理系统 
* 单道批处理系统
* 单道批处理系统的特征：自动性、顺序性、单道性
### 1.2.3多道批处理系统
* 基本概念：为了进一步提高资源的利用率和系统吞吐量，60年代中期引入了多道程序设计技术，形成了多道批处理系统。在该系统中， 用户所提交的作业都先存放在外存上并排成一个队列，称为“后备队列”；然后，由作业调度程序按一定的算法从后备队列中选择若干个作业调入内存，使它们共享CPU和系统中的各种资源。
* 优势：提高CPU利用率；可提高内存和I/O设备利用率；增加系统吞吐量
* 多道批处理系统的优缺点：资源利用率高；系统吞吐量大；平均周转时间长；无交互能力。 
* 多道批处理系统需要解决的问题：处理机管理问题；内存管理问题；I/O设备管理问题；文件管理问题；作业管理问题。
* 操作系统的定义：是一组控制和管理计算机硬件和软件资源，合理地对各类作业进行调度，以及方便用户的程序集合。
### 1.2.4分时系统
* 定义：分时操作系统是使一台计算机采用时间片轮转的方式同时为几个、几十个甚至几百个用户服务的一种操作系统。
* 产生原因：推动多道批处理系统形成和发展的主要动力，是提高资源利用率和系统吞吐量;推动分时系统形成和发展的主要动力，则是用户的需求；与多道批处理系统之间有截然不同的性能差别。
* 用户需求：人—机交互；共享主机；便于用户上机。     
* 现实中的关键问题：及时接收；及时处理。
* 特征：多路性；独立性；及时性；交互性。
### 1.2.5实时系统
#### 应用需求：实时控制、实时信息处理
#### 实时任务
* 按照执行任务的周期性(周期性实时任务、非周期性实时任务)
* 按照截止时间的要求(硬实时任务、软实时任务)
#### 实时系统与分时系统特征的比较 
* 分时系统：多路性、独立性、交互性
* 实时系统：可靠性、及时性
### 1.2.6微机操作系统的发展
* 单用户单任务操作系统
* 单用户多任务操作系统
* 多用户多任务操作系统
## 1.3操作系统的基本特性
### 1.3.1并发(Concurrence)
#### 并行与并发
* 并行性：两个或多个事件在同一时刻发生；
* 并发性：两个或多个事件在同一时间间隔内发生。
* 进程：通常的程序是静态实体(Passive Entity)，在多道程序系统中，它们是不能独立运行的，更不能和其它程序并发执行。在操作系统中引入进程的目的，就是为了使多个程序能并发执行。
* 线程：通常在一个进程中可以包含若干个线程，它们可以利用进程所拥有的资源。在引入线程的OS中，通常都是把进程作为分配资源的基本单位，而把线程作为独立运行和独立调度的基本单位。并把它视作现代操作系统的一个重要标致。 
### 1.3.2共享(Sharing)
#### 概念：系统中的资源可供内存中多个并发执行的进程(线程)共同使用
#### 资源共享方式的分类
* 互斥共享方式：规定在一段时间内只允许一个进程(线程)访问该资源。
* 同时访问方式：允许在一段时间内由多个进程“同时”对它们进行访问。
#### 并发和共享
* 临界资源/独占资源：在一段时间内只允许一个进程访问的资源。
* 操作系统的2个最基本特征：并发和共享是操作系统的两个最基本的特征，它们又是互为存在的条件。
### 1.3.3虚拟技术
#### 概念
* 操作系统中的所谓“虚拟”，是指通过某种技术把一个物理实体变为若干个逻辑上的对应物。
#### 分类
* 时分复用技术：虚拟处理机技术；虚拟设备技术
* 空分复用技术：虚拟磁盘技术；虚拟存储器技术
### 1.3.4异步性
## 1.4操作系统的主要功能
### 1.4.1处理剂管理功能
#### 进程控制
* 为作业创建进程；
* 撤消已结束的进程；
* 控制进程在运行过程中的状态转换。
#### 进程同步
* ① 进程互斥方式， 这是指诸进程(线程)在对临界资源进行访问时， 应采用互斥方式； 
* ② 进程同步方式，指在相互合作去完成共同任务的诸进程(线程)间，由同步机构对它们的执行次序加以协调。
#### 进程通信
* 由源进程利用发送命令直接将消息挂到目标进程的消息队列上，以后由目标进程利用接收命令从其消息队列中取出消息。
#### 调度
* 作业调度的基本任务：从后备队列中按照一定的算法，选择出若干个作业，为它们分配其必需的资源(首先是分配内存)。 **在将它们调入内存后，便分别为它们建立进程**，使它们都成为可能获得处理机的就绪进程，并按照一定的算法将它们插入就绪队列。
* 进程调度的任务：从进程的就绪队列中选出一新进程，**把处理机分配给它，并为它设置运行现场， 使进程投入执行**。值得提出的是，在多线程OS中，通常是把线程作为独立运行和分配处理机的基本单位，为此，须把就绪线程排成一个队列，每次调度时，是从就绪线程队列中选出一个线程，把处理机分配给它。 
### 1.4.2存储器管理功能
#### 存储器管理的2种方式
* 静态：每个作业的内存空间在作业装入时确定；装入后不允许再申请新的内存空间，不允许 “移动”； 
* 动态：每个作业所要求的基本内存空间在装入时确定，但允许在运行过程中，继续申请新的附加内存空间，也允许在内存中“移动”。 
#### 内存分配的机制中应具有这样的结构和功能：
* ① 内存分配数据结构， 该结构用于记录内存空间的使用情况， 作为内存分配的依据；
* ② 内存分配功能，系统按照一定的内存分配算法， 为用户程序分配内存空间；
* ③ 内存回收功能，系统对于用户不再需要的内存，通过用户的释放请求，去完成系统的回收功能。
#### 地址映射
* 存储器管理必须提供地址映射功能，以将地址空间中的逻辑地址转换为内存空间中与之对应的物理地址。
#### 内存扩充
* 请求调入功能
* 置换功能
### 1.4.3设备管理功能
#### 主要任务
* 完成用户进程提出的I/O请求
* 为用户进程分配其所需的I/O设备
* 提高CPU和I/O设备的利用率
* 提高I/O速度
* 方便用户使用I/O设备
#### 功能
* 缓冲管理：在I/O设备和CPU之间引入缓冲，可有效地缓和CPU和I/O设备速度不匹配的矛盾，提高CPU的利用率，进而提高系统吞吐量。常见的缓冲区机制有**单缓冲机制、双缓冲机制，公用缓冲池机制**。
* 设备分配：基本任务：根据用户进程的I/O请求、系统的现有资源情况以及按照某种设备分配策略，为之分配其所需的设备。如果在I/O设备和CPU之间，还存在着设备控制器和I/O通道时，还须为分配出去的设备分配相应的控制器和通道。设备使用完后，应立即由系统回收。 
* 设备处理：设备处理程序又称为设备驱动程序。基本任务是实现CPU和设备控制器之间的通信，即由CPU向设备控制器发出I/O命令，要求它完成指定的I/O操作；反之由CPU接收从控制器发来的中断请求，并给予迅速的响应和相应的处理。
### 1.4.4文件管理功能
#### 文件储存空间的管理
#### 目录管理
#### 文件的读/写管理和保护
* 文件的读/写管理
* 文件保护：① 防止未经核准的用户存取文件； ② 防止冒名顶替存取文件； ③ 防止以不正确的方式使用文件。
### 1.4.5用户接口
#### 命令接口
* 联机用户接口
* 脱机用户接口
#### 程序接口
#### 图形接口
## 1.5OS结构设计
### 1.5.1传统的操作系统结构
* 操作系统是一个十分复杂的大型软件。为了控制该软件的复杂性，在开发OS时，先后引入了分解、模块化、 抽象和隐蔽等方法。开发方法的不断发展，促进了OS结构的更新换代。这里，我们把第一代至第三代的OS结构， 称为传统的OS结构，而把微内核的OS结构称为现代OS结构
#### 无结构操作系统
* 在早期开发操作系统时，注意力放在功能的实现和获得高的效率上，缺乏首尾一致的设计思想。 此时的OS是为数众多的一组过程的集合，各过程之间可以相互调用，在操作系统内部不存在任何结构，也有人把它称为整体系统结构。
#### 模块化OS结构
* 模块化结构：是基于“分解”和“模块化”原则来控制大型软件的复杂度的。将OS按其功能划分为若干个具有一定独立性和大小的模块。每个模块具有某方面的管理功能，如进程管理模块、存储器管理模块、I/O设备管理模块和文件管理模块等，并规定好各模块间的接口，使各模块之间能通过该接口实现交互，再进一步将各模块细分为若干个具有一定管理功能的子模块。
* 优点:提高了OS设计的正确性、 可理解性和可维护性;增强了OS的可适应性;加速了OS的开发过程。 
* 缺点:在开始设计OS时，对模块的划分及对接口的规定并不精确，还可能存在错误，因而很难保证设计出的模块会完全正确， 这将使在把这些模块装配成OS时发生困难；从功能观点来划分模块时，未能将共享资源和独占资源加以区别 ，会使模块间存在着复杂的依赖关系,使OS结构变得不清晰。 
#### 分层式OS结构
* 有序分层的基本原则：每一层都仅使用其底层所提供的功能和服务，这样可使系统的调试和验证都变得容易 。
* 层次的设置：程序嵌套、运行频率、公用模块、用户接口
### 1.5.2客户/服务模式 C/S模式
#### 客户/服务器模式的组成
* 客户机
* 服务器
* 网络系统
#### 客户/服务器之间的交互
* 客户发送请求消息
* 服务器接收消息
* 服务器回送消息
* 客户机接收消息
#### 客户/服务器模式的优点
* 数据的分布处理和存储。
* 便于集中管理。
* 灵活性和可扩充性。
* 易于改编应用软件。　
### 1.5.3微内核OS结构
#### 微内核操作系统的基本概念
* 提供各种服务的一组服务器(进程)
* 内核
#### 特点
* 足够小的内核：① 实现与硬件紧密相关的处理；② 实现一些较基本的功能；③ 负责客户和服务器之间的通信。
* 基于客户/服务器模式
* 应用“机制与策略分离”原理：微内核操作系统中，通常将机制放在OS的微内核中。正因为如此，才有可能将内核做得很小。 
* 采用面向对象技术
#### 微内核的基本功能
* 进程(线程)管理
* 低级存储器管理
* 中断和陷入处理
#### 微内核操作系统的优点
* 提高了系统的可扩展性
* 增强了系统的可靠性
* 可移植性
* 提供了对分布式系统的支持
* 融入了面向对象技术
#### 微内核系统存在的问题
* 较之早期OS，微内核OS的运行效率有所降低
## 本章小结
* 1.操作系统的作用是什么？
* 2.操作系统的设计目标是什么？
* 3.脱机I/O方式与人工操作方式有什么进步？
* 4.什么是批处理？多道批处理与单道批处理相比有什么好处？
* 5.多道批处理需要解决哪些问题？为什么？
* 6.什么是分时系统？与批处理系统有什么差别？
* 7.什么是实时系统？与分时系统有什么差别？
* 8.微机操作系统经过哪几个阶段？WINDOWS是属于哪一种？
* 9.什么是进程？并发与并行有什么不同？
* 10.什么是共享？有哪两种共享方式？
* 11.为什么说并发和共享是操作系统的基本特征？
* 12.模块化操作系统有什么优缺点？
* 13.什么是客户/服务器模式？
* 14.微内核操作系统有哪两部分构成？功能是什么？
* 15.微内核的基本功能是什么？
* 16.微内核操作系统有什么优缺点？